```{r load-data, echo = FALSE}
??nyc_squirrels
nyc_squirrels <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-29/nyc_squirrels.csv")
```

```{r one-viz}
nyc_squirrels_colors <- nyc_squirrels %>% 
  filter(is.na(primary_fur_color) == TRUE) %>%
  ggplot(aes(x = long, y = lat, color = primary_fur_color)) +     
  geom_point() 
```

```{r cleaning-data}
nyc_squirrels <- nyc_squirrels %>%
  mutate(day_of_week = case_when(
    date %in% c(10062018, 10072018, 10132018, 10142018, 10202018, 10212018, 10272018, 10282018) ~ "weekend",
    TRUE ~ "weekday"
  ))
```
```{r behavior-variable-merge}
nyc_squirrels <- nyc_squirrels %>%
  mutate(behavior = case_when(
    running == TRUE ~ "running",
    chasing == TRUE ~ "chasing",
    climbing == TRUE ~ "climbing",
    eating == TRUE ~ "eating",
    foraging == TRUE ~ "eating",
    TRUE ~ "other"
  ))
```

```{r behavior-density-faceted-by-weekend}
ggplot(nyc_squirrels, aes(x = behavior, color = behavior, fill = behavior)) +
  geom_histogram(stat = "count") +
  facet_wrap(~day_of_week)
```

```{r stacked_bar}

ggplot(nyc_squirrels, aes(fill=primary_fur_color, x=behavior, y=primary_fur_color)) + 
    geom_bar(position="stack", stat="identity")
    

```

```{r noise-variable-merge}
nyc_squirrels <- nyc_squirrels %>%
  mutate(noise = case_when(
    kuks == TRUE ~ "kuks",
    quaas == TRUE ~ "quaas",
    moans == TRUE ~ "moans",
    TRUE ~ "no noise"
  ))
```

```{r noise-faceted-by-weekend}
ggplot(nyc_squirrels, aes(x = noise, color = noise, fill = noise)) +
  geom_histogram(stat = "count") +
  facet_wrap(~day_of_week)
```

```{r noise-faceted-by-weekend-remove-no-noise}
## Can i remove the "no noise" observation? 
ggplot(nyc_squirrels, aes(x = noise, color = noise, fill = noise)) +
  geom_histogram(stat = "count") +
  facet_wrap(~day_of_week) 
```

```{r}
lego_sales %>%
  mutate(area_code = str_sub(hectare_number, start = 1, end = 2)) %>%
  mutate(area_code = str_sub(hactare_letter, start = 3, end = 3)) %>%
```

